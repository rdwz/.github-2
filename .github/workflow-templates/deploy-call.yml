---
name: 'ðŸš€ Deploy'
on:
  push:
    branches: [ main ]
    tags: ['v*.*.*']
  workflow_dispatch:

jobs:
  deploy:
    group: ${{ github.workflow }}-${{ github.ref }}
    id: prepare_tag
    if: startsWith(github.ref, 'refs/tags/')
    run: |
      TAG_NAME="${GITHUB_REF##refs/tags/}"
      echo "::set-output name=tag_name::${TAG_NAME}"
      echo "::set-output name=deploy_tag_name::deploy-${TAG_NAME}"
    name: 'ðŸš€ Deploy'
    uses: z-shell/.github/.github/workflows/deploy-call.yml@main
    with:
      secrets:
        personal_token: ''
        deploy_key: ''
      external_repository: ''
      publish_branch: ''
      publish_dir: ''
      destination_dir: ''
      cname: ''
      keep_files: true
      allow_empty_commit: true
      full_commit_message: '${{ github.event.head_commit.message }}'
      tag_name: '${{ steps.prepare_tag.outputs.deploy_tag_name }}'
      tag_message: 'Deployment ${{ steps.prepare_tag.outputs.tag_name }}'
